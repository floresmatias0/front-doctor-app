import { Box, Button, Center, Flex, Link, Text } from '@chakra-ui/react'
import { useState } from 'react'
import '../styles/sidebarmenu.css';

const receiveMenu = (isOpen) => {
    return [
        {
            icon: `<svg className=${isOpen ? "fade-in-text" : ""} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><mask id="mask0_334_692" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24"><rect width="24" height="24" fill="#202529"/></mask><g mask="url(#mask0_334_692)"><path d="M6 19H9V14C9 13.7167 9.09583 13.4792 9.2875 13.2875C9.47917 13.0958 9.71667 13 10 13H14C14.2833 13 14.5208 13.0958 14.7125 13.2875C14.9042 13.4792 15 13.7167 15 14V19H18V10L12 5.5L6 10V19ZM4 19V10C4 9.68333 4.07083 9.38333 4.2125 9.1C4.35417 8.81667 4.55 8.58333 4.8 8.4L10.8 3.9C11.15 3.63333 11.55 3.5 12 3.5C12.45 3.5 12.85 3.63333 13.2 3.9L19.2 8.4C19.45 8.58333 19.6458 8.81667 19.7875 9.1C19.9292 9.38333 20 9.68333 20 10V19C20 19.55 19.8042 20.0208 19.4125 20.4125C19.0208 20.8042 18.55 21 18 21H14C13.7167 21 13.4792 20.9042 13.2875 20.7125C13.0958 20.5208 13 20.2833 13 20V15H11V20C11 20.2833 10.9042 20.5208 10.7125 20.7125C10.5208 20.9042 10.2833 21 10 21H6C5.45 21 4.97917 20.8042 4.5875 20.4125C4.19583 20.0208 4 19.55 4 19Z" fill="#205583"/></g></svg>`,
            title: "Home",
            href: "/"
        },
        {
            icon: `<svg className=${isOpen ? "fade-in-text" : ""} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#205583"><mask id="mask0_334_693" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24"><rect width="24" height="24" fill="#202529"/></mask><g mask="url(#mask0_334_693)"><path d="M12 21C9.9 21 8.04167 20.3625 6.425 19.0875C4.80833 17.8125 3.75833 16.1833 3.275 14.2C3.20833 13.95 3.25833 13.7208 3.425 13.5125C3.59167 13.3042 3.81667 13.1833 4.1 13.15C4.36667 13.1167 4.60833 13.1667 4.825 13.3C5.04167 13.4333 5.19167 13.6333 5.275 13.9C5.675 15.4 6.5 16.625 7.75 17.575C9 18.525 10.4167 19 12 19C13.95 19 15.6042 18.3208 16.9625 16.9625C18.3208 15.6042 19 13.95 19 12C19 10.05 18.3208 8.39583 16.9625 7.0375C15.6042 5.67917 13.95 5 12 5C10.85 5 9.775 5.26667 8.775 5.8C7.775 6.33333 6.93333 7.06667 6.25 8H8C8.28333 8 8.52083 8.09583 8.7125 8.2875C8.90417 8.47917 9 8.71667 9 9C9 9.28333 8.90417 9.52083 8.7125 9.7125C8.52083 9.90417 8.28333 10 8 10H4C3.71667 10 3.47917 9.90417 3.2875 9.7125C3.09583 9.52083 3 9.28333 3 9V5C3 4.71667 3.09583 4.47917 3.2875 4.2875C3.47917 4.09583 3.71667 4 4 4C4.28333 4 4.52083 4.09583 4.7125 4.2875C4.90417 4.47917 5 4.71667 5 5V6.35C5.85 5.28333 6.8875 4.45833 8.1125 3.875C9.3375 3.29167 10.6333 3 12 3C13.25 3 14.4208 3.2375 15.5125 3.7125C16.6042 4.1875 17.5542 4.82917 18.3625 5.6375C19.1708 6.44583 19.8125 7.39583 20.2875 8.4875C20.7625 9.57917 21 10.75 21 12C21 13.25 20.7625 14.4208 20.2875 15.5125C19.8125 16.6042 19.1708 17.5542 18.3625 18.3625C17.5542 19.1708 16.6042 19.8125 15.5125 20.2875C14.4208 20.7625 13.25 21 12 21ZM13 11.6L15.5 14.1C15.6833 14.2833 15.775 14.5167 15.775 14.8C15.775 15.0833 15.6833 15.3167 15.5 15.5C15.3167 15.6833 15.0833 15.775 14.8 15.775C14.5167 15.775 14.2833 15.6833 14.1 15.5L11.3 12.7C11.2 12.6 11.125 12.4875 11.075 12.3625C11.025 12.2375 11 12.1083 11 11.975V8C11 7.71667 11.0958 7.47917 11.2875 7.2875C11.4792 7.09583 11.7167 7 12 7C12.2833 7 12.5208 7.09583 12.7125 7.2875C12.9042 7.47917 13 7.71667 13 8V11.6Z"/></g></svg>`,
            title: "Historial",
            href: "/history"
        },
        {
            icon: `<svg className=${isOpen ? "fade-in-text" : ""} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#205583"><mask id="mask0_334_694" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24"><rect width="24" height="24" fill="#202529"/></mask><g mask="url(#mask0_334_694)"><path d="M13.8751 22H10.1251C9.87509 22 9.65843 21.9167 9.47509 21.75C9.29176 21.5833 9.18343 21.375 9.15009 21.125L8.85009 18.8C8.63343 18.7167 8.42926 18.6167 8.23759 18.5C8.04593 18.3833 7.85843 18.2583 7.67509 18.125L5.50009 19.025C5.26676 19.1083 5.03343 19.1167 4.80009 19.05C4.56676 18.9833 4.38343 18.8417 4.25009 18.625L2.40009 15.4C2.26676 15.1833 2.22509 14.95 2.27509 14.7C2.32509 14.45 2.45009 14.25 2.65009 14.1L4.52509 12.675C4.50843 12.5583 4.50009 12.4458 4.50009 12.3375V11.6625C4.50009 11.5542 4.50843 11.4417 4.52509 11.325L2.65009 9.9C2.45009 9.75 2.32509 9.55 2.27509 9.3C2.22509 9.05 2.26676 8.81667 2.40009 8.6L4.25009 5.375C4.36676 5.14167 4.54593 4.99583 4.78759 4.9375C5.02926 4.87917 5.26676 4.89167 5.50009 4.975L7.67509 5.875C7.85843 5.74167 8.05009 5.61667 8.25009 5.5C8.45009 5.38333 8.65009 5.28333 8.85009 5.2L9.15009 2.875C9.18343 2.625 9.29176 2.41667 9.47509 2.25C9.65843 2.08333 9.87509 2 10.1251 2H13.8751C14.1251 2 14.3418 2.08333 14.5251 2.25C14.7084 2.41667 14.8168 2.625 14.8501 2.875L15.1501 5.2C15.3668 5.28333 15.5709 5.38333 15.7626 5.5C15.9543 5.61667 16.1418 5.74167 16.3251 5.875L18.5001 4.975C18.7334 4.89167 18.9668 4.88333 19.2001 4.95C19.4334 5.01667 19.6168 5.15833 19.7501 5.375L21.6001 8.6C21.7334 8.81667 21.7751 9.05 21.7251 9.3C21.6751 9.55 21.5501 9.75 21.3501 9.9L19.4751 11.325C19.4918 11.4417 19.5001 11.5542 19.5001 11.6625V12.3375C19.5001 12.4458 19.4834 12.5583 19.4501 12.675L21.3251 14.1C21.5251 14.25 21.6501 14.45 21.7001 14.7C21.7501 14.95 21.7084 15.1833 21.5751 15.4L19.7251 18.6C19.5918 18.8167 19.4043 18.9625 19.1626 19.0375C18.9209 19.1125 18.6834 19.1083 18.4501 19.025L16.3251 18.125C16.1418 18.2583 15.9501 18.3833 15.7501 18.5C15.5501 18.6167 15.3501 18.7167 15.1501 18.8L14.8501 21.125C14.8168 21.375 14.7084 21.5833 14.5251 21.75C14.3418 21.9167 14.1251 22 13.8751 22ZM12.0501 15.5C13.0168 15.5 13.8418 15.1583 14.5251 14.475C15.2084 13.7917 15.5501 12.9667 15.5501 12C15.5501 11.0333 15.2084 10.2083 14.5251 9.525C13.8418 8.84167 13.0168 8.5 12.0501 8.5C11.0668 8.5 10.2376 8.84167 9.56259 9.525C8.88759 10.2083 8.55009 11.0333 8.55009 12C8.55009 12.9667 8.88759 13.7917 9.56259 14.475C10.2376 15.1583 11.0668 15.5 12.0501 15.5ZM12.0501 13.5C11.6334 13.5 11.2793 13.3542 10.9876 13.0625C10.6959 12.7708 10.5501 12.4167 10.5501 12C10.5501 11.5833 10.6959 11.2292 10.9876 10.9375C11.2793 10.6458 11.6334 10.5 12.0501 10.5C12.4668 10.5 12.8209 10.6458 13.1126 10.9375C13.4043 11.2292 13.5501 11.5833 13.5501 12C13.5501 12.4167 13.4043 12.7708 13.1126 13.0625C12.8209 13.3542 12.4668 13.5 12.0501 13.5ZM11.0001 20H12.9751L13.3251 17.35C13.8418 17.2167 14.3209 17.0208 14.7626 16.7625C15.2043 16.5042 15.6084 16.1917 15.9751 15.825L18.4501 16.85L19.4251 15.15L17.2751 13.525C17.3584 13.2917 17.4168 13.0458 17.4501 12.7875C17.4834 12.5292 17.5001 12.2667 17.5001 12C17.5001 11.7333 17.4834 11.4708 17.4501 11.2125C17.4168 10.9542 17.3584 10.7083 17.2751 10.475L19.4251 8.85L18.4501 7.15L15.9751 8.2C15.6084 7.81667 15.2043 7.49583 14.7626 7.2375C14.3209 6.97917 13.8418 6.78333 13.3251 6.65L13.0001 4H11.0251L10.6751 6.65C10.1584 6.78333 9.67926 6.97917 9.23759 7.2375C8.79593 7.49583 8.39176 7.80833 8.02509 8.175L5.55009 7.15L4.57509 8.85L6.72509 10.45C6.64176 10.7 6.58343 10.95 6.55009 11.2C6.51676 11.45 6.50009 11.7167 6.50009 12C6.50009 12.2667 6.51676 12.525 6.55009 12.775C6.58343 13.025 6.64176 13.275 6.72509 13.525L4.57509 15.15L5.55009 16.85L8.02509 15.8C8.39176 16.1833 8.79593 16.5042 9.23759 16.7625C9.67926 17.0208 10.1584 17.2167 10.6751 17.35L11.0001 20Z"/></g></svg>`,
            title: "Ajustes",
            href: "/settings"
        }
    ]
}

const SidebarMenu = () => {
    const [isOpen, setIsOpen] = useState(false)

    const handleOpen = () => setIsOpen(!isOpen)

    const sliderTransform = isOpen ? 'translateX(0)' : 'translateX(-120px)'
    const sliderTransformIcons = isOpen ? 'translateX(0)' : 'translateX(100px)'
    
    const menuItems = receiveMenu(isOpen);

    const logout = () => {
        localStorage.removeItem("user");
        window.location.href = `${
          import.meta.env.VITE_BACKEND_URL
        }/auth/google/logout`;
    };

    return (
        <Box bg='#FCFEFF' w="200px" boxShadow='md' p={4} position="absolute" top="0" left="0" h="100vh" borderRightRadius="lg" style={{ transform: sliderTransform, transition: 'transform 0.3s ease-in-out' }}>
            <Box w="100%" h="100%" position="relative">
                <Flex borderRadius="full" bg="#FCFEFF" w="36px" h="36px" position="absolute" top="10" right="-30" justifyContent="center" alignItems="center" boxShadow='xl'>
                    <Button p={0} m={0} h="100%" borderRadius="full" zIndex={10} onClick={handleOpen}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" style={isOpen ? { transform: "rotate(180deg)", transition: "rotate(0deg)", transition: "transform 0.3s ease-in-out" } : {}}>
                            <mask id="mask0_461_22" style={{ "maskType": "alpha" }} maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                                <rect width="24" height="24" fill="#202529"/>
                            </mask>
                            <g mask="url(#mask0_461_22)">
                                <mask id="mask1_461_22" style={{ "maskType": "alpha" }} maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                                    <rect width="24" height="24" fill="#D9D9D9"/>
                                </mask>
                                <g mask="url(#mask1_461_22)">
                                    <path d="M12.6 12L8.70005 8.10005C8.51672 7.91672 8.42505 7.68338 8.42505 7.40005C8.42505 7.11672 8.51672 6.88338 8.70005 6.70005C8.88338 6.51672 9.11672 6.42505 9.40005 6.42505C9.68338 6.42505 9.91672 6.51672 10.1 6.70005L14.7 11.3C14.8 11.4 14.8709 11.5084 14.9125 11.625C14.9542 11.7417 14.975 11.8667 14.975 12C14.975 12.1334 14.9542 12.2584 14.9125 12.375C14.8709 12.4917 14.8 12.6 14.7 12.7L10.1 17.3C9.91672 17.4834 9.68338 17.575 9.40005 17.575C9.11672 17.575 8.88338 17.4834 8.70005 17.3C8.51672 17.1167 8.42505 16.8834 8.42505 16.6C8.42505 16.3167 8.51672 16.0834 8.70005 15.9L12.6 12Z" fill="#205583"/>
                                </g>
                            </g>
                        </svg>
                    </Button>
                </Flex>
                <Flex flexDirection="column" justifyContent="space-between" w={isOpen ? "100%" : "80px"}h="100%" style={{ transform: sliderTransformIcons, transition: 'transform 0.3s ease-in-out' }}>
                    <Center gap={2}>
                        <svg className={isOpen ? "fade-in-text" : ""} xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
                            <mask id="mask0_334_680" style={{ "maskType": "alpha" }} maskUnits="userSpaceOnUse" x="0" y="0" width="40" height="40">
                                <rect width="40" height="40" fill="#202529"/>
                            </mask>
                            <g mask="url(#mask0_334_680)">
                                <path d="M22.4999 36.6667C19.4999 36.6667 16.9444 35.6112 14.8333 33.5C12.7221 31.3889 11.6666 28.8334 11.6666 25.8334V24.875C9.2777 24.4862 7.29159 23.3681 5.70825 21.5209C4.12492 19.6737 3.33325 17.5 3.33325 15V6.66671C3.33325 6.19449 3.49297 5.79865 3.81242 5.47921C4.13186 5.15976 4.5277 5.00004 4.99992 5.00004H8.33325C8.33325 4.52782 8.49297 4.13199 8.81242 3.81254C9.13186 3.4931 9.5277 3.33337 9.99992 3.33337C10.4721 3.33337 10.868 3.4931 11.1874 3.81254C11.5069 4.13199 11.6666 4.52782 11.6666 5.00004V8.33337C11.6666 8.8056 11.5069 9.20143 11.1874 9.52087C10.868 9.84032 10.4721 10 9.99992 10C9.5277 10 9.13186 9.84032 8.81242 9.52087C8.49297 9.20143 8.33325 8.8056 8.33325 8.33337H6.66659V15C6.66659 16.8334 7.31936 18.4028 8.62492 19.7084C9.93047 21.0139 11.4999 21.6667 13.3333 21.6667C15.1666 21.6667 16.736 21.0139 18.0416 19.7084C19.3471 18.4028 19.9999 16.8334 19.9999 15V8.33337H18.3333C18.3333 8.8056 18.1735 9.20143 17.8541 9.52087C17.5346 9.84032 17.1388 10 16.6666 10C16.1944 10 15.7985 9.84032 15.4791 9.52087C15.1596 9.20143 14.9999 8.8056 14.9999 8.33337V5.00004C14.9999 4.52782 15.1596 4.13199 15.4791 3.81254C15.7985 3.4931 16.1944 3.33337 16.6666 3.33337C17.1388 3.33337 17.5346 3.4931 17.8541 3.81254C18.1735 4.13199 18.3333 4.52782 18.3333 5.00004H21.6666C22.1388 5.00004 22.5346 5.15976 22.8541 5.47921C23.1735 5.79865 23.3333 6.19449 23.3333 6.66671V15C23.3333 17.5 22.5416 19.6737 20.9583 21.5209C19.3749 23.3681 17.3888 24.4862 14.9999 24.875V25.8334C14.9999 27.9167 15.7291 29.6875 17.1874 31.1459C18.6458 32.6042 20.4166 33.3334 22.4999 33.3334C24.5833 33.3334 26.3541 32.6042 27.8124 31.1459C29.2708 29.6875 29.9999 27.9167 29.9999 25.8334V23.0417C29.0277 22.6806 28.2291 22.0764 27.6041 21.2292C26.9791 20.382 26.6666 19.4167 26.6666 18.3334C26.6666 16.9445 27.1527 15.7639 28.1249 14.7917C29.0971 13.8195 30.2777 13.3334 31.6666 13.3334C33.0555 13.3334 34.236 13.8195 35.2083 14.7917C36.1805 15.7639 36.6666 16.9445 36.6666 18.3334C36.6666 19.4167 36.3541 20.382 35.7291 21.2292C35.1041 22.0764 34.3055 22.6806 33.3333 23.0417V25.8334C33.3333 28.8334 32.2777 31.3889 30.1666 33.5C28.0555 35.6112 25.4999 36.6667 22.4999 36.6667ZM31.6666 20C32.1388 20 32.5346 19.8403 32.8541 19.5209C33.1735 19.2014 33.3333 18.8056 33.3333 18.3334C33.3333 17.8612 33.1735 17.4653 32.8541 17.1459C32.5346 16.8264 32.1388 16.6667 31.6666 16.6667C31.1944 16.6667 30.7985 16.8264 30.4791 17.1459C30.1596 17.4653 29.9999 17.8612 29.9999 18.3334C29.9999 18.8056 30.1596 19.2014 30.4791 19.5209C30.7985 19.8403 31.1944 20 31.6666 20Z" fill="#205583"/>
                            </g>
                        </svg>
                        <Text className="fade-in-text" display={isOpen ? 'block' : 'none'} w="80px" fontSize='sm' color='#205583' style={{ fontWeight: 'bold', lineHeight: 'normal' }}>Atención pediátrica online</Text>
                    </Center>
                    <Center flexDirection="column" gap={5}>
                        {menuItems?.map((item, idx) => (
                            <Link key={idx} href={item.href}>
                                <Flex gap={2}>
                                        <div dangerouslySetInnerHTML={{__html: item.icon}}/>
                                        <Text className="fade-in-text" display={isOpen ? 'block' : 'none'} w="80px" fontSize='sm' color='#205583' style={{ fontWeight: 'bold', lineHeight: 'normal' }}>{item.title}</Text>
                                </Flex>
                            </Link>
                        ))}
                    </Center>
                    <Center>
                        <Button onClick={logout} bg="transparent">
                            <Flex gap={2}>
                                <svg className={isOpen ? "fade-in-text" : ""} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <mask id="mask0_334_695" style={{ "maskType": "alpha" }} maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                                        <rect width="24" height="24" fill="#202529"/>
                                    </mask>
                                    <g mask="url(#mask0_334_695)">
                                        <path d="M5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V16C3 15.7167 3.09583 15.4792 3.2875 15.2875C3.47917 15.0958 3.71667 15 4 15C4.28333 15 4.52083 15.0958 4.7125 15.2875C4.90417 15.4792 5 15.7167 5 16V19H19V5H5V8C5 8.28333 4.90417 8.52083 4.7125 8.7125C4.52083 8.90417 4.28333 9 4 9C3.71667 9 3.47917 8.90417 3.2875 8.7125C3.09583 8.52083 3 8.28333 3 8V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM11.65 13H4C3.71667 13 3.47917 12.9042 3.2875 12.7125C3.09583 12.5208 3 12.2833 3 12C3 11.7167 3.09583 11.4792 3.2875 11.2875C3.47917 11.0958 3.71667 11 4 11H11.65L9.8 9.15C9.6 8.95 9.50417 8.71667 9.5125 8.45C9.52083 8.18333 9.61667 7.95 9.8 7.75C10 7.55 10.2375 7.44583 10.5125 7.4375C10.7875 7.42917 11.025 7.525 11.225 7.725L14.8 11.3C14.9 11.4 14.9708 11.5083 15.0125 11.625C15.0542 11.7417 15.075 11.8667 15.075 12C15.075 12.1333 15.0542 12.2583 15.0125 12.375C14.9708 12.4917 14.9 12.6 14.8 12.7L11.225 16.275C11.025 16.475 10.7875 16.5708 10.5125 16.5625C10.2375 16.5542 10 16.45 9.8 16.25C9.61667 16.05 9.52083 15.8167 9.5125 15.55C9.50417 15.2833 9.6 15.05 9.8 14.85L11.65 13Z" fill="#205583"/>
                                    </g>
                                </svg>
                                <Text className="fade-in-text" display={isOpen ? 'block' : 'none'} w="96px" fontSize='sm' color='#205583' style={{ fontWeight: 'bold', lineHeight: 'normal', opacity: isOpen ? 1 : 0, transition: 'opacity 0.3s ease-in-out' }}>Cerrar sesión</Text>
                            </Flex>
                        </Button>
                    </Center>
                </Flex>
            </Box>
        </Box>
    )
}

export default SidebarMenu